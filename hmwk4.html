<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homework 4 | Statistics - Sapienza University of Rome</title>
    <link rel="stylesheet" href="/statistics/styles.css">
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(','\\)'], ['$', '$']],
                displayMath: [['\\[','\\]'], ['$$','$$']]
            },
            svg: { fontCache: 'global' }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <nav>
        <div class="nav-container">
            <a href="/statistics/index.html" class="logo">STATISTICS</a>
            <ul class="nav-menu">
                <li><a href="/statistics/index.html#home">Home</a></li>
                <li><a href="/statistics/hmwk2.html">HMWK 2</a></li>
                <li><a href="/statistics/hmwk3.html">HMWK 3</a></li>
                <li><a href="/statistics/hmwk4.html">HMWK 4</a></li>
            </ul>
            <div class="hamburger" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        <div class="mobile-menu">
            <ul>
                <li><a href="/statistics/index.html#home" onclick="toggleMenu()">Home</a></li>
                <li><a href="/statistics/hmwk2.html" onclick="toggleMenu()">HMWK 2</a></li>
                <li><a href="/statistics/hmwk3.html" onclick="toggleMenu()">HMWK 3</a></li>
                <li><a href="/statistics/hmwk4.html" onclick="toggleMenu()">HMWK 4</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <section class="hero-section">
            <div class="container">
                <div class="section-number">01</div>
                <div class="section-label">HOMEWORK 4</div>
                <div class="hero-content">
                    <h1>Law of Large Numbers</h1>
                    <div class="hero-underline"></div>
                    <p class="hero-description">
                        The Law of Large Numbers is one of the fundamental theorems in probability theory and statistics.
                        It states that as the number of trials in a random experiment increases, the sample average
                        converges to the expected value.

                        <div class="math-block">\[ \lim_{n \to \infty} \frac{1}{n} \sum_{i=1}^{n} X_i = \mathbb{E}[X] \]</div>

                        This theorem provides the theoretical foundation for statistical inference and explains why
                        larger samples give more reliable estimates of population parameters. In this experiment,
                        we demonstrate the Law of Large Numbers through coin flip simulations, observing how the
                        empirical frequency of successes converges to the theoretical probability of 0.5.

                        <div class="math-block">\[ P\left(\left|\frac{1}{n}\sum_{i=1}^{n} X_i - \mu\right| > \epsilon\right) \to 0 \text{ as } n \to \infty \]</div>

                        The convergence follows a normal distribution according to the Central Limit Theorem,
                        which we can visualize through the probability density of our experimental results.
                    </p>
                </div>
                <div class="scroll-indicator">
                    <div class="line"></div>
                    <div class="line"></div>
                    <div class="line"></div>
                    <div class="line"></div>
                </div>
            </div>
        </section>

        <section class="content-section">
            <div class="container">
                <div class="section-number">02</div>

                <div class="content-wrapper">
                    <h2>Law of Large Numbers Experiment</h2>
                    <p>
                        <div style="margin-bottom: 1.1em;">
                            <b>Law of Large Numbers:</b> In probability theory, the law of large numbers (LLN) states that as the number of trials in a random experiment increases, the average of the results obtained from those trials converges to the expected value. That is, the empirical mean (observed average) gets closer to the theoretical mean predicted by probability as the sample size grows.
                        </div>

                        In this experiment, we simulate multiple trials of fair coin flips (or equivalently, random bits).
                        Each trial consists of generating 50 random bits (0 or 1 with equal probability). We track:
                        <ul>
                            <li>The cumulative number of successes (1's) as we generate more bits</li>
                            <li>The distribution of final success rates across all trials</li>
                        </ul>

                        As the number of trials increases, the distribution of success rates becomes more concentrated
                        around 0.5, demonstrating the Law of Large Numbers in action.
                    </p>

                    <h3>Interactive Experiment</h3>
                    <p>
                        Select the number of trials to run and click the button below. Each trial generates 50 random
                        bits, and we visualize both the convergence process and the resulting distribution.
                    </p>

                    <!-- Controls for the experiment -->
                    <div style="margin-bottom:1.2em;">
                        <label for="llnNumTrials" style="font-weight:500;">Number of trials (n):</label>
                        <input type="number" id="llnNumTrials" value="10" min="2" max="100" step="1" style="width:70px;margin-left:.6em;margin-right:1.2em;">
                        <button class="btn" onclick="runLLNExperiment()">Run LLN Experiment</button>
                    </div>

                    <h3>Visualization 1: Convergence Process</h3>
                    <p>
                        This chart shows the cumulative number of successes (1's) for each trial as we generate
                        more bits. Notice how different trials may start differently but all tend toward the
                        expected value of 25 successes out of 50 bits (50% success rate).
                    </p>

                    <!-- Line chart for the number of successes per trial -->
                    <div style="margin-top:2em;margin-bottom:2em;">
                        <canvas id="llnLineChart" height="280"></canvas>
                    </div>

                    <h3>Visualization 2: Distribution of Success Rates</h3>
                    <p>
                        This chart shows the probability density of the final success rates across all trials.
                        As you increase the number of trials, this distribution becomes more concentrated around
                        0.5, approaching a normal distribution centered at the expected value.
                    </p>

                    <!-- Density chart for the success frequencies -->
                    <div style="margin-top:2.4em;margin-bottom:3em;">
                        <canvas id="llnDensityChart" height="200"></canvas>
                    </div>

                    <h3>Statistical Interpretation</h3>
                    <p>
                        The Law of Large Numbers has two forms:
                        <ul>
                            <li><b>Weak Law</b>: The sample average converges in probability to the expected value</li>
                            <li><b>Strong Law</b>: The sample average converges almost surely to the expected value</li>
                        </ul>

                        Our experiment demonstrates the weak law. The key insights are:
                        <ul>
                            <li>Individual trials may deviate significantly from the expected value</li>
                            <li>As we increase the number of observations within a trial, convergence improves</li>
                            <li>The distribution of averages across trials forms a bell curve (normal distribution)</li>
                            <li>This convergence is the foundation for confidence intervals and hypothesis testing</li>
                        </ul>
                    </p>

                    <script>
                        // Refs to instantiated charts for later destruction
                        let llnLineChart = null;
                        let llnDensityChart = null;

                        function runLLNExperiment() {
                            const trials = parseInt(document.getElementById('llnNumTrials').value, 10) || 10;
                            const bitsPerTrial = 50; // as specified

                            // Generate data: array of arrays per trial, each with results (0 or 1)
                            const trialResults = [];
                            const trialSuccessCounts = []; // For each trial: array of cumulative number of 1s
                            const trialSuccessFreqs = [];  // For each trial: array of cumulative freq. of 1s

                            for (let t = 0; t < trials; t++) {
                                let bits = [];
                                let cumulSuccesses = [];
                                let cumulFreqs = [];
                                let sum = 0;
                                for (let i = 0; i < bitsPerTrial; i++) {
                                    let randBit = Math.random() < 0.5 ? 0 : 1;
                                    bits.push(randBit);
                                    sum += randBit;
                                    cumulSuccesses.push(sum);
                                    cumulFreqs.push(sum / (i + 1));
                                }
                                trialResults.push(bits);
                                trialSuccessCounts.push(cumulSuccesses);
                                trialSuccessFreqs.push(cumulFreqs);
                            }

                            // --- Draw the line chart (X: number of bits, Y: number of 1s for each trial) ---
                            const lineChartCtx = document.getElementById('llnLineChart').getContext('2d');
                            if (llnLineChart) llnLineChart.destroy();

                            // Generate distinct colors for the lines
                            function getColor(idx, total) {
                                // Use HSL for visually distinct
                                let h = ((idx * 360) / total) % 360;
                                return `hsl(${h},80%,54%)`;
                            }
                            let datasets = [];
                            for (let t = 0; t < trials; t++) {
                                datasets.push({
                                    label: `Trial ${t+1}`,
                                    data: trialSuccessCounts[t],
                                    borderColor: getColor(t, trials),
                                    borderWidth: 2,
                                    fill: false,
                                    pointRadius: 0,
                                    tension: 0.10,
                                });
                            }

                            llnLineChart = new Chart(lineChartCtx, {
                                type: 'line',
                                data: {
                                    labels: [...Array(bitsPerTrial).keys()].map(i=>i+1),
                                    datasets: datasets,
                                },
                                options: {
                                    responsive: true,
                                    plugins: {
                                        legend: {
                                            display: false
                                        },
                                        title: {
                                            display: true,
                                            text: "Number of '1's (successes) vs. number of bits generated (each trial)"
                                        }
                                    },
                                    scales: {
                                        x: {
                                            title: {
                                                display: true,
                                                text: "Bits generated"
                                            },
                                            min: 1,
                                            max: bitsPerTrial,
                                        },
                                        y: {
                                            title: {
                                                display: true,
                                                text: "Cumulative number of '1's"
                                            },
                                            min: 0,
                                            max: bitsPerTrial,
                                            ticks: {
                                                stepSize: 5
                                            }
                                        }
                                    }
                                }
                            });

                            // --- Now, second chart: plot distribution of frequency of successes across trials ---
                            // For each trial: frequency = successes / bitsPerTrial (i.e., at the end of each trial)
                            const freqs = trialSuccessCounts.map(arr => arr[bitsPerTrial-1] / bitsPerTrial);

                            // Make histogram bins (e.g., 10 bins from 0.0 to 1.0)
                            const bins = 10;
                            const binWidth = 1 / bins;
                            let hist = Array(bins).fill(0);
                            for (let f of freqs) {
                                let idx = Math.floor(f / binWidth);
                                if (idx >= bins) idx = bins - 1; // Clamp upper
                                hist[idx]++;
                            }
                            // Turn counts into density: sum(hist) = trials, density = count/(total*binWidth)
                            let density = hist.map(count => count / (trials * binWidth));

                            // X axis: bin centers
                            let binCenters = Array(bins).fill(0).map((_,i)=>(i+0.5)*binWidth);

                            const densityChartCtx = document.getElementById('llnDensityChart').getContext('2d');
                            if (llnDensityChart) llnDensityChart.destroy();

                            llnDensityChart = new Chart(densityChartCtx, {
                                type: 'line',
                                data: {
                                    labels: binCenters.map(c=>c.toFixed(2)),
                                    datasets: [{
                                        label: 'Density',
                                        data: density,
                                        backgroundColor: "rgba(97, 218, 251, 0.2)",
                                        borderColor: "#218bbd",
                                        borderWidth: 2.5,
                                        fill: true,
                                        tension: 0.4,
                                        pointRadius: 3,
                                        pointBackgroundColor: "#218bbd",
                                        pointBorderColor: "#fff",
                                        pointBorderWidth: 1,
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    plugins: {
                                        legend: { display: false },
                                        title: {
                                            display: true,
                                            text: "Frequency distribution of 'success' rate (across trials)"
                                        }
                                    },
                                    scales: {
                                        x: {
                                            title: { display: true, text: "Fraction of successes (number of '1's out of 50)" }
                                        },
                                        y: {
                                            title: { display: true, text: "Density" },
                                            beginAtZero: true
                                        }
                                    }
                                }
                            });
                        }

                        function toggleMenu() {
                            const mobileMenu = document.querySelector('.mobile-menu');
                            const hamburger = document.querySelector('.hamburger');
                            mobileMenu.classList.toggle('active');
                            hamburger.classList.toggle('active');
                        }
                    </script>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-info">
                    <p class="footer-name">Andrea Altomare</p>
                    <p class="footer-detail">2199451</p>
                    <p class="footer-detail">altomare.2199451@studenti.uniroma1.it</p>
                </div>
                <div class="footer-copyright">
                    <p>&copy; 2025 Andrea Altomare</p>
                </div>
            </div>
        </div>
    </footer>
</body>
</html>

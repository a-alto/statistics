<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homework 2 | Statistics - Sapienza University of Rome</title>
    <link rel="stylesheet" href="/statistics/styles.css">
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(','\\)'], ['$', '$']],
                displayMath: [['\\[','\\]'], ['$$','$$']]
            },
            svg: { fontCache: 'global' }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <nav>
        <div class="nav-container">
            <a href="/statistics/index.html" class="logo">STATISTICS</a>
            <ul class="nav-menu">
                <li><a href="/statistics/index.html#home">Home</a></li>
                <li><a href="/statistics/hmwk2.html">HMWK 2</a></li>
            </ul>
            <div class="hamburger" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        <div class="mobile-menu">
            <ul>
                <li><a href="/statistics/index.html#home" onclick="toggleMenu()">Home</a></li>
                <li><a href="/statistics/hmwk2.html" onclick="toggleMenu()">HMWK 2</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <section class="hero-section">
            <div class="container">
                <div class="section-number">01</div>
                <div class="section-label">HOMEWORK 2</div>
                <div class="hero-content">
                    <h1>Concepts: Dataset and Distribution</h1>
                    <div class="hero-underline"></div>
                    <p class="hero-description">
                        A <b>dataset</b> is a finite collection of observed values, typically written as
                        \( X = \{x_1, x_2, \dots, x_n\} \), where \( n \) is the sample size.
                        It represents a concrete realization of an underlying random mechanism. Descriptive statistics
                        summarize key aspects of the dataset to make patterns visible and comparable across studies.

                        <div class="math-block">\[ \bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i \]</div>
                        <div class="math-block">\[ s^2 = \frac{1}{n-1} \sum_{i=1}^{n} (x_i - \bar{x})^2 \]</div>

                        A <b>distribution</b> is a mathematical model for how values of a random variable are generated; we write
                        \( X \sim P \) to denote that \( X \) follows distribution
                        \( P \). Parametric families (e.g., normal, binomial, Poisson) describe entire
                        classes of behaviors using few parameters. For instance, the normal distribution is denoted by
                        \( X \sim \mathcal{N}(\mu, \sigma^2) \), controlled by mean \( \mu \)
                        and variance \( \sigma^2 \).

                        Statistical inference links the dataset to the underlying distribution to estimate parameters,
                        quantify uncertainty, and test hypotheses about the data-generating process.
                    </p>
                </div>
                <div class="scroll-indicator">
                    <div class="line"></div>
                    <div class="line"></div>
                    <div class="line"></div>
                    <div class="line"></div>
                </div>
            </div>
        </section>

        <section class="content-section">
            <div class="container">
                <div class="section-number">02</div>
                <!-- <div class="section-label">Computing the univariate distributions</div> -->

                <div class="content-wrapper">
                    <h2>Computing the univariate distribution</h2>
                    <p>
                        For this work I created a table of students containing some data.

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Student ID</th>
                                    <th>Full Name</th>
                                    <th>Age</th>
                                    <th>Gender</th>
                                    <th>Height (cm)</th>
                                    <th>Weight (kg)</th>
                                    <th>Major</th>
                                    <th>Part-time Job</th>
                                    <th>Commute (min)</th>
                                </tr>
                            </thead>
                             <tbody>
                                 <tr>
                                     <td>1</td>
                                     <td>Sofia Bianchi</td>
                                     <td>19</td>
                                     <td>F</td>
                                     <td>164.0</td>
                                     <td>56.0</td>
                                     <td>Psychology</td>
                                     <td>No</td>
                                     <td>15.0</td>
                                 </tr>
                                 <tr>
                                     <td>2</td>
                                     <td>Luca Rossi</td>
                                     <td>21</td>
                                     <td>M</td>
                                     <td>178.0</td>
                                     <td>74.0</td>
                                     <td>Engineering</td>
                                     <td>Yes</td>
                                     <td>40.0</td>
                                 </tr>
                                 <tr>
                                     <td>3</td>
                                     <td>Giulia Conti</td>
                                     <td>21</td>
                                     <td>F</td>
                                     <td>178.0</td>
                                     <td>60.0</td>
                                     <td>Biology</td>
                                     <td>No</td>
                                     <td>10.0</td>
                                 </tr>
                                 <tr>
                                     <td>4</td>
                                     <td>Matteo Greco</td>
                                     <td>19</td>
                                     <td>M</td>
                                     <td>180.0</td>
                                     <td>82.0</td>
                                     <td>Business</td>
                                     <td>Yes</td>
                                     <td>45.0</td>
                                 </tr>
                                 <tr>
                                     <td>5</td>
                                     <td>Chiara Esposito</td>
                                     <td>20</td>
                                     <td>F</td>
                                     <td>160.0</td>
                                     <td>52.0</td>
                                     <td>Literature</td>
                                     <td>No</td>
                                     <td>25.0</td>
                                 </tr>
                                 <tr>
                                     <td>6</td>
                                     <td>Marco De Luca</td>
                                     <td>21</td>
                                     <td>M</td>
                                     <td>178.0</td>
                                     <td>70.0</td>
                                     <td>Computer Science</td>
                                     <td>No</td>
                                     <td>30.0</td>
                                 </tr>
                                 <tr>
                                     <td>7</td>
                                     <td>Alice Romano</td>
                                     <td>19</td>
                                     <td>F</td>
                                     <td>178.0</td>
                                     <td>65.0</td>
                                     <td>Sociology</td>
                                     <td>Yes</td>
                                     <td>35.0</td>
                                 </tr>
                                 <tr>
                                     <td>8</td>
                                     <td>Andrea Moretti</td>
                                     <td>19</td>
                                     <td>M</td>
                                     <td>180.0</td>
                                     <td>77.0</td>
                                     <td>Physics</td>
                                     <td>No</td>
                                     <td>20.0</td>
                                 </tr>
                                 <tr>
                                     <td>9</td>
                                     <td>Francesca Galli</td>
                                     <td>23</td>
                                     <td>F</td>
                                     <td>164.0</td>
                                     <td>59.0</td>
                                     <td>Economics</td>
                                     <td>Yes</td>
                                     <td>50.0</td>
                                 </tr>
                                 <tr>
                                     <td>10</td>
                                     <td>Davide Ferri</td>
                                     <td>21</td>
                                     <td>M</td>
                                     <td>180.0</td>
                                     <td>68.0</td>
                                     <td>Mathematics</td>
                                     <td>No</td>
                                     <td>15.0</td>
                                 </tr>
                             </tbody>
                        </table>

                        After that, I computed the univariate distribution on the height variable.

                         <pre class="code-block">
                             <code class="language-sql">
                                 <span class="keyword">SELECT</span>              
                                     height_cm,
                                     <span class="function">COUNT</span>(*) <span class="keyword">AS</span> frequency
                                 <span class="keyword">FROM</span> students
                                 <span class="keyword">GROUP BY</span> height_cm
                                 <span class="keyword">ORDER BY</span> height_cm;
                             </code>
                         </pre>

                         Obtaining these results:

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Height (cm)</th>
                                    <th>Frequency</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>160.0</td>
                                    <td>1</td>
                                </tr>
                                <tr>
                                    <td>164.0</td>
                                    <td>2</td>
                                </tr>
                                <tr>
                                    <td>178.0</td>
                                    <td>4</td>
                                </tr>
                                <tr>
                                    <td>180.0</td>
                                    <td>3</td>
                                </tr>
                            </tbody>
                        </table>
                        <div style="max-width: 440px; margin: 1.7rem auto;">
                            <canvas id="heightHistogram" width="400" height="260"></canvas>
                        </div>
                        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                        <script>
                            const ctx = document.getElementById('heightHistogram').getContext('2d');
                            new Chart(ctx, {
                                type: 'bar',
                                data: {
                                    labels: ['160.0', '164.0', '178.0', '180.0'],
                                    datasets: [{
                                        label: 'Frequency',
                                        data: [1, 2, 4, 3],
                                        backgroundColor: 'rgba(36, 163, 225, 0.64)',
                                        borderColor: 'rgba(36, 163, 225, 1)',
                                        borderWidth: 1.5,
                                        borderRadius: 5,
                                        maxBarThickness: 48,
                                    }]
                                },
                                options: {
                                    layout: { padding: 8 },
                                    plugins: {
                                        legend: { display: false },
                                        title: {
                                            display: true,
                                            text: 'Histogram of Heights (cm)',
                                            color: '#e8e8e8',
                                            font: { size: 17, weight: 'bold' }
                                        }
                                    },
                                    scales: {
                                        x: {
                                            title: { display: true, text: 'Height (cm)', color: '#b8b8b8', font: { size: 15 } },
                                            ticks: { color: '#b8b8b8', font: { size: 13 } },
                                            grid: { color: 'rgba(255,255,255,0.10)' }
                                        },
                                        y: {
                                            title: { display: true, text: 'Frequency', color: '#b8b8b8', font: { size: 15 } },
                                            beginAtZero: true,
                                            ticks: { stepSize: 1, color: '#b8b8b8', font: { size: 13 } },
                                            grid: { color: 'rgba(255,255,255,0.12)' }
                                        }
                                    }
                                }
                            });
                        </script>
                    </p>
                </div>
            </div>
        </section>

        <section class="content-section">
            <div class="container">
                <div class="section-number">03</div>
                <!-- <div class="section-label">Computing the univariate distributions</div> -->

                <div class="content-wrapper">
                    <h2>Computing the bivariate distribution</h2>
                    <p>
                        Using the same table as above, I computed the bivariate distribution on the height and the age variables.

                         <pre class="code-block">
                             <code class="language-sql">
                                <span class="keyword">SELECT</span>
                                    age,
                                    height_cm,
                                    <span class="function">COUNT</span>(*) <span class="keyword">AS</span> frequency
                                <span class="keyword">FROM</span> students
                                <span class="keyword">GROUP BY</span> age, height_cm
                                <span class="keyword">ORDER BY</span> age, height_cm;
                             </code>
                         </pre>

                         Obtaining these results:

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Age</th>
                                    <th>Height (cm)</th>
                                    <th>Frequency</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>19</td>
                                    <td>164.0</td>
                                    <td>1</td>
                                </tr>
                                <tr>
                                    <td>19</td>
                                    <td>180.0</td>
                                    <td>2</td>
                                </tr>
                                <tr>
                                    <td>20</td>
                                    <td>178.0</td>
                                    <td>1</td>
                                </tr>
                                <tr>
                                    <td>21</td>
                                    <td>160.0</td>
                                    <td>1</td>
                                </tr>
                                <tr>
                                    <td>21</td>
                                    <td>178.0</td>
                                    <td>2</td>
                                </tr>
                            </tbody>
                        </table>
                            
                        <div style="margin-top:2em;margin-bottom:2em;">
                            <h4>Visualization graph</h4>
                             <div id="plotly-3d-table" style="width:100%;max-width:600px;height:400px;"></div>
                             <script>
                             function createPlot() {
                                 // Check if Plotly is available
                                 if (typeof Plotly === 'undefined') {
                                     console.error('Plotly is not loaded');
                                     return;
                                 }

                                 // Data from the table
                                 var ages     = [19, 19, 20, 21, 21];
                                 var heights  = [164.0, 180.0, 178.0, 160.0, 178.0];
                                 var freq     = [1, 2, 1, 1, 2];

                                 var trace = {
                                     x: ages,
                                     y: heights,
                                     z: freq,
                                     mode: 'markers+text',
                                     marker: {
                                         size: 8,
                                         color: freq,
                                         colorscale: 'Viridis',
                                         showscale: true,
                                         colorbar: { title: 'Frequency' }
                                     },
                                     text: freq.map(String),
                                     textposition: 'top center',
                                     type: 'scatter3d',
                                     hovertemplate: 
                                     'Age: %{x}<br>Height: %{y} cm<br>Freq: %{z}<extra></extra>'
                                 };

                                 var layout = {
                                     margin: {l: 0, r: 0, b: 0, t: 30},
                                     scene: {
                                         xaxis: {title: 'Age', dtick: 1, tickmode: 'linear'},
                                         yaxis: {title: 'Height (cm)', dtick: 4},
                                         zaxis: {title: 'Frequency', dtick: 1, rangemode: 'tozero'},
                                     },
                                     title: {
                                         text: '3D Joint Distribution: Age, Height, Frequency',
                                         font: { size: 16 }
                                     }
                                 };

                                 Plotly.newPlot('plotly-3d-table', [trace], layout, {responsive: true});
                             }

                             // Wait for page to load and Plotly to be available
                             window.addEventListener('load', createPlot);
                             </script>
                        </div>
                    </p>
                </div>
            </div>
        </section>

        <section class="content-section">
            <div class="container">
                <div class="section-number">04</div>
                <!-- <div class="section-label">Breaking the Caesar chipher: frequency analysis</div> -->

                <div class="content-wrapper">
                    <h2>Frequency analysis of a text</h2>
                    <p>
                        Let's analyze the frequency of the letters in an academic paper.

                        <div style="margin: 2rem 0;">
                            <object 
                                data="./assets/hmwk2/quantum.pdf" 
                                type="application/pdf"
                                width="100%" 
                                height="600px"
                                style="border: 1px solid #444; border-radius: 8px; background: #222;">
                                <p>Your browser doesn't support PDFs. <a href="./assets/hmwk2/quantum.pdf" target="_blank" style="color: #61dafb;">Click here to download the PDF</a>.</p>
                            </object>
                            <div style="font-size: 0.95em; color: #b8b8b8; margin-top: 0.5rem;">
                                If the PDF does not load, <a href="./assets/hmwk2/quantum.pdf" target="_blank" style="color: #61dafb;">click here to download/view quantum.pdf</a>.
                            </div>
                        </div>

                        <button class="btn" onclick="analyzeFrequency()">Analyze Frequency</button>
                        <br>
                        <button class="btn" onclick="showEnglishFrequency()">Show frequency of English letters</button>
                        <br>
                        Comparing the two distributions, we can see that the frequency of the letters in the academic paper is very similar to the frequency of the letters in English.
                    </p>
                </div>
            </div>
        </section>

        <section class="content-section">
            <div class="container">
                <div class="section-number">05</div>
                <!-- <div class="section-label">Breaking the Caesar chipher: frequency analysis</div> -->

                <div class="content-wrapper">
                    <h2>Breaking the Caesar chipher: frequency analysis</h2>
                    <p>
                        Now we will apply the concept of distribution to break the Caesar chipher through an attack method called <b>frequency analysis</b>.

                        Type your text below (should be long enough).

                        <div style="margin-top: 2rem; margin-bottom: 1rem;">
                            <label for="inputText" style="font-weight: 500;">Input text:</label><br>
                            <textarea id="inputText" rows="5" style="width: 100%; margin-bottom: 1rem; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; padding: 0.75rem 1rem; color: #e8e8e8; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace; font-size: 0.95rem; outline: none; resize: vertical; min-height: 100px; line-height: 1.6;">A quantum computer is a (real or theoretical) computer that uses quantum mechanical phenomena in an essential way: it exploits superposed and entangled states, and the intrinsically non-deterministic outcomes of quantum measurements, as features of its computation. Quantum computers can be viewed as sampling from quantum systems that evolve in ways classically described as operating on an enormous number of possibilities simultaneously, though still subject to strict computational constraints. By contrast, ordinary ("classical") computers operate according to deterministic rules. Any classical computer can, in principle, be replicated by a (classical) mechanical device such as a Turing machine, with only polynomial overhead in time. Quantum computers, on the other hand are believed to require exponentially more resources to simulate classically. It is widely believed that a scalable quantum computer could perform some calculations exponentially faster than any classical computer. Theoretically, a large-scale quantum computer could break some widely used public-key cryptographic schemes and aid physicists in performing physical simulations. However, current hardware implementations of quantum computation are largely experimental and only suitable for specialized tasks.
                                The basic unit of information in quantum computing, the qubit (or "quantum bit"), serves the same function as the bit in ordinary or "classical" computing. However, unlike a classical bit, which can be in one of two states (a binary), a qubit can exist in a linear combination of two states known as a quantum superposition. The result of measuring a qubit is one of the two states given by a probabilistic rule. If a quantum computer manipulates the qubit in a particular way, wave interference effects amplify the probability of the desired measurement result. The design of quantum algorithms involves creating procedures that allow a quantum computer to perform this amplification.
                                Quantum computers are not yet practical for real-world applications. Physically engineering high-quality qubits has proven to be challenging. If a physical qubit is not sufficiently isolated from its environment, it suffers from quantum decoherence, introducing noise into calculations. National governments have invested heavily in experimental research aimed at developing scalable qubits with longer coherence times and lower error rates. Example implementations include superconductors (which isolate an electrical current by eliminating electrical resistance) and ion traps (which confine a single atomic particle using electromagnetic fields). Researchers have claimed, and are widely believed to be correct, that certain quantum devices can outperform classical computers on narrowly defined tasks, a milestone referred to as quantum advantage or quantum supremacy. These tasks are not necessarily useful for real-world applications.
                            </textarea>
                        </div>
                        <!-- INSERT_YOUR_CODE -->
                        <div style="margin-bottom: 1rem;">
                            <button class="btn" onclick="computeLetterFrequency()">Compute Letter Frequency &amp; Show Histogram</button>
                        </div>
                        <div style="margin-bottom:1.5rem; max-width:600px;">
                            <canvas id="letterFrequencyChart" height="200"></canvas>
                        </div>
                        <script>
                        let letterFreqChart = null;

                        function computeLetterFrequency() {
                            const text = document.getElementById('inputText').value;
                            // Calculate frequencies
                            let freq = Array(26).fill(0);
                            let total = 0;
                            for (let c of text.toUpperCase()) {
                                const idx = c.charCodeAt(0) - 65;
                                if (idx >= 0 && idx < 26) {
                                    freq[idx]++;
                                    total++;
                                }
                            }
                            // Convert to percent
                            const freqPercent = freq.map(f => total ? 100 * f / total : 0);

                            // Plot with Chart.js
                            if (letterFreqChart) letterFreqChart.destroy();
                            const ctx = document.getElementById('letterFrequencyChart').getContext('2d');
                            letterFreqChart = new Chart(ctx, {
                                type: 'bar',
                                data: {
                                    labels: Array.from({length:26},(_,i)=>String.fromCharCode(65+i)),
                                    datasets: [{
                                        label: 'Letter Frequency (%)',
                                        data: freqPercent,
                                        backgroundColor: '#4bc0c0cc',
                                        borderColor: '#086363',
                                        borderWidth: 1
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    plugins: {
                                        legend: { display: false }
                                    },
                                    scales: {
                                        x: {
                                            title: { display:true, text:'Letter' },
                                            grid: { display: false }
                                        },
                                        y: {
                                            beginAtZero: true,
                                            title: { display: true, text: "Frequency (%)" }
                                        }
                                    }
                                }
                            });
                        }
                        </script>
                        <div style="margin-bottom: 1rem;">
                            <label for="caesarShift" style="font-weight: 500;">Caesar shift:</label>
                            <input type="number" id="caesarShift" value="3" style="width:60px; margin-left: 0.5em; margin-right: 1em; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; padding: 0.5rem; color: #e8e8e8; font-family: 'DM Sans', sans-serif; font-size: 0.95rem; outline: none;">
                            <button class="btn" onclick="applyCaesarCipher()">Apply Shift</button>
                        </div>
                        <div style="margin-bottom: 0.5rem;">
                            <label for="outputText" style="font-weight: 500;">Ciphered output:</label><br>
                            <textarea id="outputText" rows="5" style="width: 100%; background: rgba(0, 0, 0, 0.2); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 6px; padding: 0.75rem 1rem; color: #9ca3af; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace; font-size: 0.95rem; outline: none; resize: vertical; min-height: 100px; line-height: 1.6;" readonly></textarea>
                        </div>

                        <button class="btn" onclick="breakCaesarCipher()">Break Caesar Cipher (Auto-Decipher)</button>
                        <br><br>
                        <label for="decipheredText" style="font-weight: 500;">Deciphered text:</label><br>
                        <textarea id="decipheredText" rows="5" style="width: 100%; background: rgba(0, 0, 0, 0.2); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 6px; padding: 0.75rem 1rem; color: #9ca3af; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace; font-size: 0.95rem; outline: none; resize: vertical; min-height: 100px; line-height: 1.6;" readonly></textarea>
                        <div id="histogram-freq-container" style="display: flex; flex-wrap: wrap; gap: 2rem; margin-top: 1.5rem;">
                            <div style="flex:1; min-width:450px;">
                                <b>Letter Frequency (Ciphered):</b>
                                <canvas id="cipheredFreqChart" style="width: 100% !important; height: 350px !important;"></canvas>
                            </div>
                            <div style="flex:1; min-width:450px;">
                                <b>Letter Frequency (Detected Language):</b>
                                <div id="detectedLangLabel" style="color:#aaf; margin-bottom:0.3em;"></div>
                                <canvas id="languageFreqChart" style="width: 100% !important; height: 350px !important;"></canvas>
                            </div>
                        </div>
                        <script>
                        // Major languages' typical letter frequencies (A-Z, normalized)
                        const languageFrequencies = {
                            English: [8.167,1.492,2.782,4.253,12.702,2.228,2.015,6.094,6.966,0.153,0.772,4.025,2.406,6.749,7.507,1.929,0.095,5.987,6.327,9.056,2.758,0.978,2.360,0.150,1.974,0.074],
                            French:  [7.636,0.901,3.260,3.669,14.715,1.066,0.866,0.737,7.529,0.613,0.049,5.456,2.968,7.095,5.796,2.521,1.362,6.693,7.948,7.244,6.311,1.628,0.114,0.427,0.128,0.326],
                            German:  [6.516,1.886,2.732,5.076,16.396,1.656,3.009,4.577,6.550,0.268,1.417,3.437,2.534,9.776,2.594,0.670,0.018,7.003,7.270,6.154,4.166,0.846,1.921,0.034,0.039,1.134],
                            Italian: [11.745,0.927,4.501,3.736,11.792,1.153,1.644,0.636,10.143,0.011,0.009,6.510,2.512,6.883,9.832,3.056,0.505,6.367,4.981,5.623,3.011,2.097,0.033,0.003,0.020,1.181],
                            Spanish: [12.525,2.215,4.019,5.010,13.681,0.692,1.768,0.703,6.247,0.493,0.011,4.967,3.157,6.712,8.683,2.510,0.877,6.871,7.977,4.632,2.927,1.138,0.017,0.215,1.008,0.467]
                        };

                        // Letter labels A-Z
                        const alphabet = Array.from({length: 26}, (_, i) => String.fromCharCode(65 + i));

                        // Utility: calculate frequencies of A-Z letters in given text (as percentages)
                        function getLetterFrequencies(text) {
                            let freq = Array(26).fill(0);
                            let total = 0;
                            for (let ch of text.toUpperCase()) {
                                const idx = ch.charCodeAt(0) - 65;
                                if (idx >= 0 && idx < 26) {
                                    freq[idx]++;
                                    total++;
                                }
                            }
                            if (total === 0) return freq;
                            return freq.map(f => (f * 100) / total);
                        }

                        // Utility: chi-squared distance, for matching distributions
                        function chiSquared(observed, expected) {
                            let dist = 0;
                            for (let i = 0; i < 26; i++) {
                                if (expected[i] > 0) { // Avoid division by zero
                                    let diff = observed[i] - expected[i];
                                    dist += (diff * diff) / expected[i];
                                }
                            }
                            return dist;
                        }

                        // Estimate Caesar shift by minimizing chi-squared distance to best-fit language
                        function estimateShiftAndLanguage(cipherFreq) {
                            let best = {shift: 0, lang: 'English', dist: Infinity};
                            for (const [lang, langFreqs] of Object.entries(languageFrequencies)) {
                                for (let shift = 0; shift < 26; shift++) {
                                    let shifted = cipherFreq.slice();
                                    // Unshifted version (simulate decrypting Caesar)
                                    shifted = shifted.map((_, idx) => cipherFreq[(idx+shift)%26]);
                                    const dist = chiSquared(shifted, langFreqs);
                                    if (dist < best.dist) {
                                        best = {shift: shift, lang: lang, dist: dist};
                                    }
                                }
                            }
                            return best;
                        }

                        // Caesar decryption (shift backwards)
                        function caesarDecipher(text, shift) {
                            shift = ((shift % 26) + 26) % 26;
                            function unshiftChar(c) {
                                const code = c.charCodeAt(0);
                                if (code >= 65 && code <= 90) { // uppercase
                                    return String.fromCharCode(((code - 65 - shift + 26) % 26) + 65);
                                }
                                if (code >= 97 && code <= 122) { // lowercase
                                    return String.fromCharCode(((code - 97 - shift + 26) % 26) + 97);
                                }
                                return c;
                            }
                            let deciphered = '';
                            for (let i = 0; i < text.length; i++) {
                                deciphered += unshiftChar(text[i]);
                            }
                            return deciphered;
                        }

                        // --- plotting with Chart.js ---

                        let cipheredChart = null, languageChart = null;

                        function plotFrequencyHistogram(canvasId, frequencies, chartRef, color='#3af', label='Frequency (%)') {
                            const ctx = document.getElementById(canvasId).getContext('2d');
                            if (chartRef && chartRef.destroy) chartRef.destroy();
                            return new Chart(ctx, {
                                type: 'bar',
                                data: {
                                    labels: alphabet,
                                    datasets: [{
                                        label: label,
                                        data: frequencies.map(x => +x.toFixed(2)),
                                        backgroundColor: color,
                                        borderColor: "#111b",
                                        borderWidth: 1,
                                    }]
                                },
                                options: {
                                    responsive: false,
                                    plugins: {
                                        legend: { display: false }
                                    },
                                    scales: {
                                        x: { title: {display: true, text: 'Letter'}, grid: {display:false} },
                                        y: { beginAtZero: true, title: {display:true, text:'Frequency (%)'} }
                                    }
                                }
                            });
                        }

                        function breakCaesarCipher() {
                            const cipheredText = document.getElementById('outputText').value;
                            if (!cipheredText.trim()) {
                                alert("Please apply the Caesar cipher first!");
                                return;
                            }
                            // 1. Frequency analysis
                            const freq = getLetterFrequencies(cipheredText);

                            // 2. Estimate shift and language
                            const { shift, lang } = estimateShiftAndLanguage(freq);

                            // 3. Decipher using found shift
                            const deciphered = caesarDecipher(cipheredText, shift);

                            document.getElementById('decipheredText').value = deciphered;

                            // 4. Plot histograms
                            if (cipheredChart) cipheredChart.destroy();
                            if (languageChart) languageChart.destroy();
                            cipheredChart = plotFrequencyHistogram('cipheredFreqChart', freq, cipheredChart, '#3af', 'Ciphered');
                            languageChart = plotFrequencyHistogram('languageFreqChart', languageFrequencies[lang], languageChart, '#faa', `${lang} (avg)`);

                            // 5. Show detected language
                            document.getElementById('detectedLangLabel').textContent = "Detected language: " + lang;
                        }
                        </script>

                        <script>
                        function applyCaesarCipher() {
                            const text = document.getElementById('inputText').value;
                            let shift = parseInt(document.getElementById('caesarShift').value) || 0;
                            shift = ((shift % 26) + 26) % 26; // normalize shift

                            function shiftChar(c) {
                                const code = c.charCodeAt(0);
                                if (code >= 65 && code <= 90) { // uppercase
                                    return String.fromCharCode(((code - 65 + shift) % 26) + 65);
                                }
                                if (code >= 97 && code <= 122) { // lowercase
                                    return String.fromCharCode(((code - 97 + shift) % 26) + 97);
                                }
                                return c;
                            }

                            let ciphered = '';
                            for (let i = 0; i < text.length; i++) {
                                ciphered += shiftChar(text[i]);
                            }
                            document.getElementById('outputText').value = ciphered;
                        }
                        </script>

                        <br>

                        Here is the JavaScript code used to break the Caesar cipher:

                        <pre style="background: rgba(0, 0, 0, 0.3); color: #e8e8e8; border-radius: 8px; padding: 1.5rem; padding-top: 2.5rem; font-size: 0.9rem; overflow-x: auto; margin: 2rem 0; border: 1px solid rgba(255, 255, 255, 0.1); font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace; line-height: 1.6; position: relative; white-space: pre;">
                            <span style="position: absolute; top: 0.5rem; right: 1rem; background: rgba(255, 223, 0, 0.15); color: #f0db4f; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: 600; letter-spacing: 0.05em;">JavaScript</span>
                            <code><span style="color: #5c6370; font-style: italic;">/**
                                * Calculate frequencies of A-Z letters in given text (as percentages)
                                */</span>
                                <span style="color: #c678dd; font-weight: 600;">function</span> <span style="color: #61afef;">getLetterFrequencies</span>(text) {
                                    <span style="color: #c678dd; font-weight: 600;">let</span> freq = <span style="color: #61afef;">Array</span>(<span style="color: #d19a66;">26</span>).<span style="color: #61afef;">fill</span>(<span style="color: #d19a66;">0</span>);
                                    <span style="color: #c678dd; font-weight: 600;">let</span> total = <span style="color: #d19a66;">0</span>;
                                    <span style="color: #c678dd; font-weight: 600;">for</span> (<span style="color: #c678dd; font-weight: 600;">let</span> ch <span style="color: #c678dd; font-weight: 600;">of</span> text.<span style="color: #61afef;">toUpperCase</span>()) {
                                        <span style="color: #c678dd; font-weight: 600;">const</span> idx = ch.<span style="color: #61afef;">charCodeAt</span>(<span style="color: #d19a66;">0</span>) - <span style="color: #d19a66;">65</span>;
                                        <span style="color: #c678dd; font-weight: 600;">if</span> (idx >= <span style="color: #d19a66;">0</span> && idx < <span style="color: #d19a66;">26</span>) {
                                            freq[idx]++;
                                            total++;
                                        }
                                    }
                                    <span style="color: #c678dd; font-weight: 600;">if</span> (total === <span style="color: #d19a66;">0</span>) <span style="color: #c678dd; font-weight: 600;">return</span> freq;
                                    <span style="color: #c678dd; font-weight: 600;">return</span> freq.<span style="color: #61afef;">map</span>(f => (f * <span style="color: #d19a66;">100</span>) / total);
                                }


                                <span style="color: #5c6370; font-style: italic;">/**
                                * Compute chi-squared distance between two distributions
                                */</span>
                                <span style="color: #c678dd; font-weight: 600;">function</span> <span style="color: #61afef;">chiSquared</span>(observed, expected) {
                                    <span style="color: #c678dd; font-weight: 600;">let</span> dist = <span style="color: #d19a66;">0</span>;
                                    <span style="color: #c678dd; font-weight: 600;">for</span> (<span style="color: #c678dd; font-weight: 600;">let</span> i = <span style="color: #d19a66;">0</span>; i &lt; <span style="color: #d19a66;">26</span>; i++) {
                                        <span style="color: #c678dd; font-weight: 600;">if</span> (expected[i] &gt; <span style="color: #d19a66;">0</span>) { <span style="color: #5c6370; font-style: italic;">// Avoid division by zero</span>
                                            <span style="color: #c678dd; font-weight: 600;">let</span> diff = observed[i] - expected[i];
                                            dist += (diff * diff) / expected[i];
                                        }
                                    }
                                    <span style="color: #c678dd; font-weight: 600;">return</span> dist;
                                }


                                <span style="color: #5c6370; font-style: italic;">/**
                                * Estimate Caesar shift and best language by minimizing chi-squared distance
                                */</span>
                                <span style="color: #c678dd; font-weight: 600;">function</span> <span style="color: #61afef;">estimateShiftAndLanguage</span>(cipherFreq) {
                                    <span style="color: #c678dd; font-weight: 600;">let</span> best = {shift: <span style="color: #d19a66;">0</span>, lang: <span style="color: #98c379;">'English'</span>, dist: <span style="color: #d19a66;">Infinity</span>};
                                    <span style="color: #c678dd; font-weight: 600;">for</span> (<span style="color: #c678dd; font-weight: 600;">const</span> [lang, langFreqs] <span style="color: #c678dd; font-weight: 600;">of</span> <span style="color: #61afef;">Object</span>.<span style="color: #61afef;">entries</span>(languageFrequencies)) {
                                        <span style="color: #c678dd; font-weight: 600;">for</span> (<span style="color: #c678dd; font-weight: 600;">let</span> shift = <span style="color: #d19a66;">0</span>; shift &lt; <span style="color: #d19a66;">26</span>; shift++) {
                                            <span style="color: #c678dd; font-weight: 600;">let</span> shifted = cipherFreq.<span style="color: #61afef;">slice</span>();
                                            <span style="color: #5c6370; font-style: italic;">// Unshifted version (simulate decrypting Caesar)</span>
                                            shifted = shifted.<span style="color: #61afef;">map</span>((_, idx) =&gt; cipherFreq[(idx+shift)%<span style="color: #d19a66;">26</span>]);
                                            <span style="color: #c678dd; font-weight: 600;">const</span> dist = <span style="color: #61afef;">chiSquared</span>(shifted, langFreqs);
                                            <span style="color: #c678dd; font-weight: 600;">if</span> (dist &lt; best.dist) {
                                                best = {shift: shift, lang: lang, dist: dist};
                                            }
                                        }
                                    }
                                    <span style="color: #c678dd; font-weight: 600;">return</span> best;
                                }


                                <span style="color: #5c6370; font-style: italic;">/**
                                * Caesar decryption (shift backwards)
                                */</span>
                                <span style="color: #c678dd; font-weight: 600;">function</span> <span style="color: #61afef;">caesarDecipher</span>(text, shift) {
                                    shift = ((shift % <span style="color: #d19a66;">26</span>) + <span style="color: #d19a66;">26</span>) % <span style="color: #d19a66;">26</span>;
                                    <span style="color: #c678dd; font-weight: 600;">function</span> <span style="color: #61afef;">unshiftChar</span>(c) {
                                        <span style="color: #c678dd; font-weight: 600;">const</span> code = c.<span style="color: #61afef;">charCodeAt</span>(<span style="color: #d19a66;">0</span>);
                                        <span style="color: #c678dd; font-weight: 600;">if</span> (code &gt;= <span style="color: #d19a66;">65</span> &amp;&amp; code &lt;= <span style="color: #d19a66;">90</span>) { <span style="color: #5c6370; font-style: italic;">// uppercase</span>
                                            <span style="color: #c678dd; font-weight: 600;">return</span> <span style="color: #61afef;">String</span>.<span style="color: #61afef;">fromCharCode</span>(((code - <span style="color: #d19a66;">65</span> - shift + <span style="color: #d19a66;">26</span>) % <span style="color: #d19a66;">26</span>) + <span style="color: #d19a66;">65</span>);
                                        }
                                        <span style="color: #c678dd; font-weight: 600;">if</span> (code &gt;= <span style="color: #d19a66;">97</span> &amp;&amp; code &lt;= <span style="color: #d19a66;">122</span>) { <span style="color: #5c6370; font-style: italic;">// lowercase</span>
                                            <span style="color: #c678dd; font-weight: 600;">return</span> <span style="color: #61afef;">String</span>.<span style="color: #61afef;">fromCharCode</span>(((code - <span style="color: #d19a66;">97</span> - shift + <span style="color: #d19a66;">26</span>) % <span style="color: #d19a66;">26</span>) + <span style="color: #d19a66;">97</span>);
                                        }
                                        <span style="color: #c678dd; font-weight: 600;">return</span> c;
                                    }
                                    <span style="color: #c678dd; font-weight: 600;">let</span> deciphered = <span style="color: #98c379;">''</span>;
                                    <span style="color: #c678dd; font-weight: 600;">for</span> (<span style="color: #c678dd; font-weight: 600;">let</span> i = <span style="color: #d19a66;">0</span>; i &lt; text.length; i++) {
                                        deciphered += <span style="color: #61afef;">unshiftChar</span>(text[i]);
                                    }
                                    <span style="color: #c678dd; font-weight: 600;">return</span> deciphered;
                                }


                                <span style="color: #5c6370; font-style: italic;">/**
                                * Break Caesar cipher: detect shift, detect language, show deciphered text, show frequency histograms
                                */</span>
                                <span style="color: #c678dd; font-weight: 600;">function</span> <span style="color: #61afef;">breakCaesarCipher</span>() {
                                    <span style="color: #c678dd; font-weight: 600;">const</span> cipheredText = <span style="color: #e5c07b;">document</span>.<span style="color: #61afef;">getElementById</span>(<span style="color: #98c379;">'outputText'</span>).value;
                                    <span style="color: #c678dd; font-weight: 600;">if</span> (!cipheredText.<span style="color: #61afef;">trim</span>()) {
                                        <span style="color: #61afef;">alert</span>(<span style="color: #98c379;">"Please apply the Caesar cipher first!"</span>);
                                        <span style="color: #c678dd; font-weight: 600;">return</span>;
                                    }
                                    <span style="color: #5c6370; font-style: italic;">// 1. Frequency analysis</span>
                                    <span style="color: #c678dd; font-weight: 600;">const</span> freq = <span style="color: #61afef;">getLetterFrequencies</span>(cipheredText);

                                    <span style="color: #5c6370; font-style: italic;">// 2. Estimate shift and language</span>
                                    <span style="color: #c678dd; font-weight: 600;">const</span> { shift, lang } = <span style="color: #61afef;">estimateShiftAndLanguage</span>(freq);

                                    <span style="color: #5c6370; font-style: italic;">// 3. Decipher using found shift</span>
                                    <span style="color: #c678dd; font-weight: 600;">const</span> deciphered = <span style="color: #61afef;">caesarDecipher</span>(cipheredText, shift);

                                    <span style="color: #e5c07b;">document</span>.<span style="color: #61afef;">getElementById</span>(<span style="color: #98c379;">'decipheredText'</span>).value = deciphered;

                                    <span style="color: #5c6370; font-style: italic;">// 4. Plot histograms</span>
                                    <span style="color: #c678dd; font-weight: 600;">if</span> (cipheredChart) cipheredChart.<span style="color: #61afef;">destroy</span>();
                                    <span style="color: #c678dd; font-weight: 600;">if</span> (languageChart) languageChart.<span style="color: #61afef;">destroy</span>();
                                    cipheredChart = <span style="color: #61afef;">plotFrequencyHistogram</span>(<span style="color: #98c379;">'cipheredFreqChart'</span>, freq, cipheredChart, <span style="color: #98c379;">'#3af'</span>, <span style="color: #98c379;">'Ciphered'</span>);
                                    languageChart = <span style="color: #61afef;">plotFrequencyHistogram</span>(<span style="color: #98c379;">'languageFreqChart'</span>, languageFrequencies[lang], languageChart, <span style="color: #98c379;">'#faa'</span>, <span style="color: #98c379;">`${lang} (avg)`</span>);

                                    <span style="color: #5c6370; font-style: italic;">// 5. Show detected language</span>
                                    <span style="color: #e5c07b;">document</span>.<span style="color: #61afef;">getElementById</span>(<span style="color: #98c379;">'detectedLangLabel'</span>).textContent = <span style="color: #98c379;">"Detected language: "</span> + lang;
                                }
                            </code>
                        </pre>
                    </p>
                </div>
            </div>
        </section>

        <!-- <section class="content-section">
            <div class="container">
                <div class="section-number">02</div>
                <div class="section-label">OVERVIEW</div>

                <div class="content-wrapper">
                    <div class="content-columns">
                        <div class="column">
                            <h2>Experiment Overview</h2>
                            <p>
                                The objective was to evaluate whether the treatment leads to a measurable
                                improvement in the target metric compared to the control condition.
                                A simple randomized design was used with two groups: Control (C) and Treatment (T).
                            </p>
                            <ul>
                                <li><b>Design</b>: Two-sample comparison (independent groups)</li>
                                <li><b>Sample size</b>: n_C = 50, n_T = 50</li>
                                <li><b>Primary metric</b>: Continuous outcome (e.g., response time, score)</li>
                                <li><b>Significance level</b>: \( \alpha = 0.05 \)</li>
                            </ul>
                        </div>
                        <div class="column">
                            <h2>Data & Methods</h2>
                            <p>
                                We computed descriptive statistics, 95% confidence intervals for group means,
                                and conducted a two-sample t-test assuming unequal variances (Welch's test).
                                Normality was assessed visually; results were robust to mild deviations.
                            </p>
                            <ul>
                                <li><b>Descriptives</b>: mean, standard deviation, standard error</li>
                                <li><b>Inference</b>: 95% CI, Welch two-sample t-test</li>
                                <li><b>Effect size</b>: Hedges' g with small-sample correction</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="content-section">
            <div class="container">
                <div class="section-number">03</div>
                <div class="section-label">RESULTS</div>

                <div class="content-wrapper">
                    <h2>Summary Statistics</h2>
                    <div class="content-columns">
                        <div class="column">
                            <h3>Group Descriptives</h3>
                            <p>
                                The treatment group shows a lower mean (better performance) than control.
                                The confidence intervals have limited overlap, suggesting a real difference.
                            </p>
                            <table style="width:100%; border-collapse:collapse; border-top:1px solid rgba(255,255,255,0.1);">
                                <thead>
                                    <tr style="text-align:left;">
                                        <th style="padding:0.75rem 0; color:#e8e8e8;">Group</th>
                                        <th style="padding:0.75rem 0; color:#e8e8e8;">n</th>
                                        <th style="padding:0.75rem 0; color:#e8e8e8;">Mean</th>
                                        <th style="padding:0.75rem 0; color:#e8e8e8;">SD</th>
                                        <th style="padding:0.75rem 0; color:#e8e8e8;">95% CI</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="padding:0.5rem 0; color:#b8b8b8;">Control</td>
                                        <td style="padding:0.5rem 0; color:#b8b8b8;">50</td>
                                        <td style="padding:0.5rem 0; color:#b8b8b8;">12.4</td>
                                        <td style="padding:0.5rem 0; color:#b8b8b8;">4.1</td>
                                        <td style="padding:0.5rem 0; color:#b8b8b8;">[11.2, 13.6]</td>
                                    </tr>
                                    <tr>
                                        <td style="padding:0.5rem 0; color:#b8b8b8;">Treatment</td>
                                        <td style="padding:0.5rem 0; color:#b8b8b8;">50</td>
                                        <td style="padding:0.5rem 0; color:#b8b8b8;">10.1</td>
                                        <td style="padding:0.5rem 0; color:#b8b8b8;">3.8</td>
                                        <td style="padding:0.5rem 0; color:#b8b8b8;">[9.0, 11.1]</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="column">
                            <h3>Hypothesis Test</h3>
                            <ul>
                                <li><b>Null</b>: \( \mu_T - \mu_C = 0 \)</li>
                                <li><b>Alternative</b>: \( \mu_T - \mu_C \neq 0 \)</li>
                                <li><b>Test</b>: Welch two-sample t-test</li>
                                <li><b>Statistic</b>: \( t = -3.29 \)</li>
                                <li><b>df</b>: 95.7</li>
                                <li><b>p-value</b>: 0.0014</li>
                                <li><b>Effect size</b>: Hedges' g = 0.60</li>
                            </ul>
                            <p>
                                At \( \alpha = 0.05 \), we reject the null hypothesis and conclude that the treatment
                                has a statistically significant effect on the outcome.
                            </p>
                        </div>
                    </div>

                    <h2 style="margin-top:4rem;">Key Findings</h2>
                    <ul>
                        <li>The treatment outperforms control with a moderate effect size.</li>
                        <li>Results are statistically significant at the 5% level.</li>
                        <li>Observed variability is comparable across groups.</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="content-section">
            <div class="container">
                <div class="section-number">04</div>
                <div class="section-label">CONCLUSION</div>

                <div class="content-wrapper">
                    <h2>Conclusion</h2>
                    <p>
                        The analysis indicates a meaningful improvement associated with the treatment. Future work
                        should replicate these findings with larger samples, assess robustness to distributional
                        assumptions, and evaluate potential confounders.
                    </p>
                </div>
            </div>
        </section> -->
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-info">
                    <p class="footer-name">Andrea Altomare</p>
                    <p class="footer-detail">2199451</p>
                    <p class="footer-detail">altomare.2199451@studenti.uniroma1.it</p>
                </div>
                <div class="footer-copyright">
                    <p>&copy; 2025 Andrea Altomare</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        function toggleMenu() {
            const mobileMenu = document.querySelector('.mobile-menu');
            const hamburger = document.querySelector('.hamburger');
            mobileMenu.classList.toggle('active');
            hamburger.classList.toggle('active');
        }
    </script>
    <script src="./code/hmwk2/frequency_analysis.js"></script>
</body>
</html>

